*** Settings ***
Suite Setup       Get Test Data    1.1-6. Share special files
Resource          ../Resource/BusinessKeywords.txt
Resource          ../Resource/LogicKeywords.txt

*** Test Cases ***
Can share file has many page
    ${v_test_data}=    Set Variable    ${test_data[0]}
    Connect To Email    ${v_test_data['Direct Recipient']}    ${v_test_data['Email Pass']}
    Open Web App    browser1
    SignIn    ${v_test_data['Owner']}    ${v_test_data['Owner Pass']}
    ${v_pathToDataFile}=    Join Path    ${cfg_test_data_location}    FileTypeSupported    ${v_test_data['File']}
    Delete All Email
    String File    ${v_pathToDataFile}    ${v_test_data['Direct Recipient']}    ${v_test_data['Access Level']}    ${v_test_data['Expiration']}    ${v_test_data['Allow Printing']}    ${v_test_data['Display Watermark']}
    ...    ${v_test_data['Note']}
    Check File Exist    ${v_test_data['File']}
    #Check Email
    Wait For Email
    ${v_expected_email}=    Evaluate    {'body':[${v_test_data['Expected Email Body']}], 'subject':'${v_test_data['Expected Email Subject']}'}
    ${v_result}=    Check Email Content    ${v_expected_email}
    Should Be Equal    ${v_result}    ${EMPTY}
    # Recipient view received file
    Open Web App    browser2
    SignIn    ${v_test_data['Direct Recipient']}    ${v_test_data['Direct Recipient Pass']}
    Navigate To Folder    ${v_test_data['Received Folder']}
    Check File Exist    ${v_test_data['Received File']}
    [Teardown]    Run Keywords    Submit Test Result    ${v_test_data['TestcaseID']}    ${TEST_STATUS}    AND    Close Connection
    ...    AND    Switch Browser    browser1    AND    Delete File    ${v_test_data['File']}
    ...    AND    Close All Browsers

Can share file excel has many sheet
    ${v_test_data}=    Set Variable    ${test_data[1]}
    Connect To Email    ${v_test_data['Direct Recipient']}    ${v_test_data['Email Pass']}
    Open Web App    browser1
    SignIn    ${v_test_data['Owner']}    ${v_test_data['Owner Pass']}
    ${v_pathToDataFile}=    Join Path    ${cfg_test_data_location}    FileTypeSupported    ${v_test_data['File']}
    Delete All Email
    String File    ${v_pathToDataFile}    ${v_test_data['Direct Recipient']}    ${v_test_data['Access Level']}    ${v_test_data['Expiration']}    ${v_test_data['Allow Printing']}    ${v_test_data['Display Watermark']}
    ...    ${v_test_data['Note']}    120
    Check File Exist    ${v_test_data['File']}
    #Check Email
    Wait For Email
    ${v_expected_email}=    Evaluate    {'body':[${v_test_data['Expected Email Body']}], 'subject':'${v_test_data['Expected Email Subject']}'}
    ${v_result}=    Check Email Content    ${v_expected_email}
    Should Be Equal    ${v_result}    ${EMPTY}
    # Recipient view received file
    Open Web App    browser2
    SignIn    ${v_test_data['Direct Recipient']}    ${v_test_data['Direct Recipient Pass']}
    Navigate To Folder    ${v_test_data['Received Folder']}
    Check File Exist    ${v_test_data['Received File']}
    [Teardown]    Run Keywords    Submit Test Result    ${v_test_data['TestcaseID']}    ${TEST_STATUS}    AND    Close Connection
    ...    AND    Switch Browser    browser1    AND    Delete File    ${v_test_data['File']}
    ...    AND    Close All Browsers

Can share file has large dimension
    ${v_test_data}=    Set Variable    ${test_data[2]}
    Connect To Email    ${v_test_data['Direct Recipient']}    ${v_test_data['Email Pass']}
    Open Web App    browser1
    SignIn    ${v_test_data['Owner']}    ${v_test_data['Owner Pass']}
    ${v_pathToDataFile}=    Join Path    ${cfg_test_data_location}    FileTypeSupported    ${v_test_data['File']}
    Delete All Email
    String File    ${v_pathToDataFile}    ${v_test_data['Direct Recipient']}    ${v_test_data['Access Level']}    ${v_test_data['Expiration']}    ${v_test_data['Allow Printing']}    ${v_test_data['Display Watermark']}
    ...    ${v_test_data['Note']}
    Check File Exist    ${v_test_data['File']}
    #Check Email
    Wait For Email
    ${v_expected_email}=    Evaluate    {'body':[${v_test_data['Expected Email Body']}], 'subject':'${v_test_data['Expected Email Subject']}'}
    ${v_result}=    Check Email Content    ${v_expected_email}
    Should Be Equal    ${v_result}    ${EMPTY}
    # Recipient view received file
    Open Web App    browser2
    SignIn    ${v_test_data['Direct Recipient']}    ${v_test_data['Direct Recipient Pass']}
    Navigate To Folder    ${v_test_data['Received Folder']}
    Check File Exist    ${v_test_data['Received File']}
    [Teardown]    Run Keywords    Submit Test Result    ${v_test_data['TestcaseID']}    ${TEST_STATUS}    AND    Close Connection
    ...    AND    Switch Browser    browser1    AND    Delete File    ${v_test_data['File']}
    ...    AND    Close All Browsers

Can share file has large file size
    ${v_test_data}=    Set Variable    ${test_data[3]}
    Connect To Email    ${v_test_data['Direct Recipient']}    ${v_test_data['Email Pass']}
    Open Web App    browser1
    SignIn    ${v_test_data['Owner']}    ${v_test_data['Owner Pass']}
    ${v_pathToDataFile}=    Join Path    ${cfg_test_data_location}    FileTypeSupported    ${v_test_data['File']}
    Delete All Email
    String File    ${v_pathToDataFile}    ${v_test_data['Direct Recipient']}    ${v_test_data['Access Level']}    ${v_test_data['Expiration']}    ${v_test_data['Allow Printing']}    ${v_test_data['Display Watermark']}
    ...    ${v_test_data['Note']}
    Check File Exist    ${v_test_data['File']}
    #Check Email
    Wait For Email
    ${v_expected_email}=    Evaluate    {'body':[${v_test_data['Expected Email Body']}], 'subject':'${v_test_data['Expected Email Subject']}'}
    ${v_result}=    Check Email Content    ${v_expected_email}
    Should Be Equal    ${v_result}    ${EMPTY}
    # Recipient view received file
    Open Web App    browser2
    SignIn    ${v_test_data['Direct Recipient']}    ${v_test_data['Direct Recipient Pass']}
    Navigate To Folder    ${v_test_data['Received Folder']}
    Check File Exist    ${v_test_data['Received File']}
    [Teardown]    Run Keywords    Submit Test Result    ${v_test_data['TestcaseID']}    ${TEST_STATUS}    AND    Close Connection
    ...    AND    Switch Browser    browser1    AND    Delete File    ${v_test_data['File']}
    ...    AND    Close All Browsers

Can share file name length is inside allowed range that DB allows
    ${v_test_data}=    Set Variable    ${test_data[4]}
    Connect To Email    ${v_test_data['Direct Recipient']}    ${v_test_data['Email Pass']}
    Open Web App    browser1
    SignIn    ${v_test_data['Owner']}    ${v_test_data['Owner Pass']}
    ${v_pathToDataFile}=    Join Path    ${cfg_test_data_location}    FileTypeSupported    ${v_test_data['File']}
    Delete All Email
    String File    ${v_pathToDataFile}    ${v_test_data['Direct Recipient']}    ${v_test_data['Access Level']}    ${v_test_data['Expiration']}    ${v_test_data['Allow Printing']}    ${v_test_data['Display Watermark']}
    ...    ${v_test_data['Note']}
    Check File Exist    ${v_test_data['File']}
    #Check Email
    Wait For Email
    ${v_expected_email}=    Evaluate    {'body':[${v_test_data['Expected Email Body']}], 'subject':'${v_test_data['Expected Email Subject']}'}
    ${v_result}=    Check Email Content    ${v_expected_email}
    Should Be Equal    ${v_result}    ${EMPTY}
    # Recipient view received file
    Open Web App    browser2
    SignIn    ${v_test_data['Direct Recipient']}    ${v_test_data['Direct Recipient Pass']}
    Navigate To Folder    ${v_test_data['Received Folder']}
    Check File Exist    ${v_test_data['Received File']}
    [Teardown]    Run Keywords    Submit Test Result    ${v_test_data['TestcaseID']}    ${TEST_STATUS}    AND    Close Connection
    ...    AND    Switch Browser    browser1    AND    Delete File    ${v_test_data['File']}
    ...    AND    Close All Browsers

CANNOT share file name length is outside allowed range that DB allows
    ${v_test_data}=    Set Variable    ${test_data[5]}
    Connect To Email    ${v_test_data['Direct Recipient']}    ${v_test_data['Email Pass']}
    Open Web App    browser1
    SignIn    ${v_test_data['Owner']}    ${v_test_data['Owner Pass']}
    ${v_pathToDataFile}=    Join Path    ${cfg_test_data_location}    FileTypeSupported    ${v_test_data['File']}
    Delete All Email
    String File    ${v_pathToDataFile}    ${v_test_data['Direct Recipient']}    ${v_test_data['Access Level']}    ${v_test_data['Expiration']}    ${v_test_data['Allow Printing']}    ${v_test_data['Display Watermark']}
    ...    ${v_test_data['Note']}
    Check File Exist    ${v_test_data['File']}
    #Check Email
    Wait For Email
    ${v_expected_email}=    Evaluate    {'body':[${v_test_data['Expected Email Body']}], 'subject':'${v_test_data['Expected Email Subject']}'}
    ${v_result}=    Check Email Content    ${v_expected_email}
    Should Be Equal    ${v_result}    ${EMPTY}
    # Recipient view received file
    Open Web App    browser2
    SignIn    ${v_test_data['Direct Recipient']}    ${v_test_data['Direct Recipient Pass']}
    Navigate To Folder    ${v_test_data['Received Folder']}
    Check File Exist    ${v_test_data['Received File']}
    [Teardown]    Run Keywords    Submit Test Result    ${v_test_data['TestcaseID']}    ${TEST_STATUS}    AND    Close Connection
    ...    AND    Switch Browser    browser1    AND    Delete File    ${v_test_data['File']}
    ...    AND    Close All Browsers

Can share file name has special characters
    ${v_test_data}=    Set Variable    ${test_data[6]}
    Connect To Email    ${v_test_data['Direct Recipient']}    ${v_test_data['Email Pass']}
    Open Web App    browser1
    SignIn    ${v_test_data['Owner']}    ${v_test_data['Owner Pass']}
    ${v_pathToDataFile}=    Join Path    ${cfg_test_data_location}    FileTypeSupported    ${v_test_data['File']}
    Delete All Email
    String File    ${v_pathToDataFile}    ${v_test_data['Direct Recipient']}    ${v_test_data['Access Level']}    ${v_test_data['Expiration']}    ${v_test_data['Allow Printing']}    ${v_test_data['Display Watermark']}
    ...    ${v_test_data['Note']}
    Check File Exist    ${v_test_data['File']}
    #Check Email
    Wait For Email
    ${v_expected_email}=    Evaluate    {'body':[${v_test_data['Expected Email Body']}], 'subject':'${v_test_data['Expected Email Subject']}'}
    ${v_result}=    Check Email Content    ${v_expected_email}
    Should Be Equal    ${v_result}    ${EMPTY}
    # Recipient view received file
    Open Web App    browser2
    SignIn    ${v_test_data['Direct Recipient']}    ${v_test_data['Direct Recipient Pass']}
    Navigate To Folder    ${v_test_data['Received Folder']}
    Check File Exist    ${v_test_data['Received File']}
    [Teardown]    Run Keywords    Submit Test Result    ${v_test_data['TestcaseID']}    ${TEST_STATUS}    AND    Close Connection
    ...    AND    Switch Browser    browser1    AND    Delete File    ${v_test_data['File']}
    ...    AND    Close All Browsers

Can share file has extension in lower
    ${v_test_data}=    Set Variable    ${test_data[7]}
    Connect To Email    ${v_test_data['Direct Recipient']}    ${v_test_data['Email Pass']}
    Open Web App    browser1
    SignIn    ${v_test_data['Owner']}    ${v_test_data['Owner Pass']}
    ${v_pathToDataFile}=    Join Path    ${cfg_test_data_location}    FileTypeSupported    ${v_test_data['File']}
    Delete All Email
    String File    ${v_pathToDataFile}    ${v_test_data['Direct Recipient']}    ${v_test_data['Access Level']}    ${v_test_data['Expiration']}    ${v_test_data['Allow Printing']}    ${v_test_data['Display Watermark']}
    ...    ${v_test_data['Note']}
    Check File Exist    ${v_test_data['File']}
    #Check Email
    Wait For Email
    ${v_expected_email}=    Evaluate    {'body':[${v_test_data['Expected Email Body']}], 'subject':'${v_test_data['Expected Email Subject']}'}
    ${v_result}=    Check Email Content    ${v_expected_email}
    Should Be Equal    ${v_result}    ${EMPTY}
    # Recipient view received file
    Open Web App    browser2
    SignIn    ${v_test_data['Direct Recipient']}    ${v_test_data['Direct Recipient Pass']}
    Navigate To Folder    ${v_test_data['Received Folder']}
    Check File Exist    ${v_test_data['Received File']}
    [Teardown]    Run Keywords    Submit Test Result    ${v_test_data['TestcaseID']}    ${TEST_STATUS}    AND    Close Connection
    ...    AND    Switch Browser    browser1    AND    Delete File    ${v_test_data['File']}
    ...    AND    Close All Browsers

Can share file has extension in capital
    ${v_test_data}=    Set Variable    ${test_data[8]}
    Connect To Email    ${v_test_data['Direct Recipient']}    ${v_test_data['Email Pass']}
    Open Web App    browser1
    SignIn    ${v_test_data['Owner']}    ${v_test_data['Owner Pass']}
    ${v_pathToDataFile}=    Join Path    ${cfg_test_data_location}    FileTypeSupported    ${v_test_data['File']}
    Delete All Email
    String File    ${v_pathToDataFile}    ${v_test_data['Direct Recipient']}    ${v_test_data['Access Level']}    ${v_test_data['Expiration']}    ${v_test_data['Allow Printing']}    ${v_test_data['Display Watermark']}
    ...    ${v_test_data['Note']}
    Check File Exist    ${v_test_data['File']}
    #Check Email
    Wait For Email
    ${v_expected_email}=    Evaluate    {'body':[${v_test_data['Expected Email Body']}], 'subject':'${v_test_data['Expected Email Subject']}'}
    ${v_result}=    Check Email Content    ${v_expected_email}
    Should Be Equal    ${v_result}    ${EMPTY}
    # Recipient view received file
    Open Web App    browser2
    SignIn    ${v_test_data['Direct Recipient']}    ${v_test_data['Direct Recipient Pass']}
    Navigate To Folder    ${v_test_data['Received Folder']}
    Check File Exist    ${v_test_data['Received File']}
    [Teardown]    Run Keywords    Submit Test Result    ${v_test_data['TestcaseID']}    ${TEST_STATUS}    AND    Close Connection
    ...    AND    Switch Browser    browser1    AND    Delete File    ${v_test_data['File']}
    ...    AND    Close All Browsers

Can share document file which has editing restriction
    ${v_test_data}=    Set Variable    ${test_data[9]}
    Connect To Email    ${v_test_data['Direct Recipient']}    ${v_test_data['Email Pass']}
    Open Web App    browser1
    SignIn    ${v_test_data['Owner']}    ${v_test_data['Owner Pass']}
    ${v_pathToDataFile}=    Join Path    ${cfg_test_data_location}    FileTypeSupported    ${v_test_data['File']}
    Delete All Email
    String File    ${v_pathToDataFile}    ${v_test_data['Direct Recipient']}    ${v_test_data['Access Level']}    ${v_test_data['Expiration']}    ${v_test_data['Allow Printing']}    ${v_test_data['Display Watermark']}
    ...    ${v_test_data['Note']}
    Check File Exist    ${v_test_data['File']}
    #Check Email
    Wait For Email
    ${v_expected_email}=    Evaluate    {'body':[${v_test_data['Expected Email Body']}], 'subject':'${v_test_data['Expected Email Subject']}'}
    ${v_result}=    Check Email Content    ${v_expected_email}
    Should Be Equal    ${v_result}    ${EMPTY}
    # Recipient view received file
    Open Web App    browser2
    SignIn    ${v_test_data['Direct Recipient']}    ${v_test_data['Direct Recipient Pass']}
    Navigate To Folder    ${v_test_data['Received Folder']}
    Check File Exist    ${v_test_data['Received File']}
    [Teardown]    Run Keywords    Submit Test Result    ${v_test_data['TestcaseID']}    ${TEST_STATUS}    AND    Close Connection
    ...    AND    Switch Browser    browser1    AND    Delete File    ${v_test_data['File']}
    ...    AND    Close All Browsers

Can/Cannot share file has password file belong to browser
    ${v_test_data}=    Set Variable    ${test_data[10]}
    Connect To Email    ${v_test_data['Direct Recipient']}    ${v_test_data['Email Pass']}
    Open Web App    browser1
    SignIn    ${v_test_data['Owner']}    ${v_test_data['Owner Pass']}
    ${v_pathToDataFile}=    Join Path    ${cfg_test_data_location}    FileTypeSupported    ${v_test_data['File']}
    Delete All Email
    String File    ${v_pathToDataFile}    ${v_test_data['Direct Recipient']}    ${v_test_data['Access Level']}    ${v_test_data['Expiration']}    ${v_test_data['Allow Printing']}    ${v_test_data['Display Watermark']}
    ...    ${v_test_data['Note']}
    Check File Exist    ${v_test_data['File']}
    #Check Email
    Wait For Email
    ${v_expected_email}=    Evaluate    {'body':[${v_test_data['Expected Email Body']}], 'subject':'${v_test_data['Expected Email Subject']}'}
    ${v_result}=    Check Email Content    ${v_expected_email}
    Should Be Equal    ${v_result}    ${EMPTY}
    # Recipient view received file
    Open Web App    browser2
    SignIn    ${v_test_data['Direct Recipient']}    ${v_test_data['Direct Recipient Pass']}
    Navigate To Folder    ${v_test_data['Received Folder']}
    Check File Exist    ${v_test_data['Received File']}
    [Teardown]    Run Keywords    Submit Test Result    ${v_test_data['TestcaseID']}    ${TEST_STATUS}    AND    Close Connection
    ...    AND    Switch Browser    browser1    AND    Delete File    ${v_test_data['File']}
    ...    AND    Close All Browsers

Can/Cannot share file is corrupted belong to browser
    ${v_test_data}=    Set Variable    ${test_data[11]}
    Connect To Email    ${v_test_data['Direct Recipient']}    ${v_test_data['Email Pass']}
    Open Web App    browser1
    SignIn    ${v_test_data['Owner']}    ${v_test_data['Owner Pass']}
    ${v_pathToDataFile}=    Join Path    ${cfg_test_data_location}    FileTypeSupported    ${v_test_data['File']}
    Delete All Email
    String File    ${v_pathToDataFile}    ${v_test_data['Direct Recipient']}    ${v_test_data['Access Level']}    ${v_test_data['Expiration']}    ${v_test_data['Allow Printing']}    ${v_test_data['Display Watermark']}
    ...    ${v_test_data['Note']}
    Check File Exist    ${v_test_data['File']}
    #Check Email
    Wait For Email
    ${v_expected_email}=    Evaluate    {'body':[${v_test_data['Expected Email Body']}], 'subject':'${v_test_data['Expected Email Subject']}'}
    ${v_result}=    Check Email Content    ${v_expected_email}
    Should Be Equal    ${v_result}    ${EMPTY}
    # Recipient view received file
    Open Web App    browser2
    SignIn    ${v_test_data['Direct Recipient']}    ${v_test_data['Direct Recipient Pass']}
    Navigate To Folder    ${v_test_data['Received Folder']}
    Check File Exist    ${v_test_data['Received File']}
    [Teardown]    Run Keywords    Submit Test Result    ${v_test_data['TestcaseID']}    ${TEST_STATUS}    AND    Close Connection
    ...    AND    Switch Browser    browser1    AND    Delete File    ${v_test_data['File']}
    ...    AND    Close All Browsers

Cannot share file has 0 KB
    ${v_test_data}=    Set Variable    ${test_data[12]}
    Connect To Email    ${v_test_data['Direct Recipient']}    ${v_test_data['Email Pass']}
    Delete All Email
    Open Web App    browser1
    SignIn    ${v_test_data['Owner']}    ${v_test_data['Owner Pass']}
    Click    ${Btn_StringFile}
    Wait For Progress Bar
    ${v_pathToDataFile}=    Join Path    ${cfg_test_data_location}    FileTypeSupported
    Upload File    ${v_pathToDataFile}
    Selenium2Library.Page Should Contain    Unable to string this file. The file is empty
    ${v_isEmailSent}=    Run Keyword And Return Status    Wait For Email    20    10
    Should Be Equal    ${v_isEmailSent}    ${False}    Should NOT receive email but it does
    [Teardown]    Run Keywords    Submit Test Result    ${v_test_data['TestcaseID']}    ${TEST_STATUS}    AND    Close Connection
    ...    AND    Switch Browser    browser1    AND    Delete File    ${v_test_data['File']}
    ...    AND    Close All Browsers

Can share excel file has password cell or sheet
    ${v_test_data}=    Set Variable    ${test_data[13]}
    Connect To Email    ${v_test_data['Direct Recipient']}    ${v_test_data['Email Pass']}
    Open Web App    browser1
    SignIn    ${v_test_data['Owner']}    ${v_test_data['Owner Pass']}
    ${v_pathToDataFile}=    Join Path    ${cfg_test_data_location}    FileTypeSupported    ${v_test_data['File']}
    Delete All Email
    String File    ${v_pathToDataFile}    ${v_test_data['Direct Recipient']}    ${v_test_data['Access Level']}    ${v_test_data['Expiration']}    ${v_test_data['Allow Printing']}    ${v_test_data['Display Watermark']}
    ...    ${v_test_data['Note']}
    Check File Exist    ${v_test_data['File']}
    #Check Email
    Wait For Email
    ${v_expected_email}=    Evaluate    {'body':[${v_test_data['Expected Email Body']}], 'subject':'${v_test_data['Expected Email Subject']}'}
    ${v_result}=    Check Email Content    ${v_expected_email}
    Should Be Equal    ${v_result}    ${EMPTY}
    # Recipient view received file
    Open Web App    browser2
    SignIn    ${v_test_data['Direct Recipient']}    ${v_test_data['Direct Recipient Pass']}
    Navigate To Folder    ${v_test_data['Received Folder']}
    Check File Exist    ${v_test_data['Received File']}
    [Teardown]    Run Keywords    Submit Test Result    ${v_test_data['TestcaseID']}    ${TEST_STATUS}    AND    Close Connection
    ...    AND    Switch Browser    browser1    AND    Delete File    ${v_test_data['File']}
    ...    AND    Close All Browsers

Can share file which has extension in the file name
    ${v_test_data}=    Set Variable    ${test_data[14]}
    Connect To Email    ${v_test_data['Direct Recipient']}    ${v_test_data['Email Pass']}
    Open Web App    browser1
    SignIn    ${v_test_data['Owner']}    ${v_test_data['Owner Pass']}
    ${v_pathToDataFile}=    Join Path    ${cfg_test_data_location}    FileTypeSupported    ${v_test_data['File']}
    Delete All Email
    String File    ${v_pathToDataFile}    ${v_test_data['Direct Recipient']}    ${v_test_data['Access Level']}    ${v_test_data['Expiration']}    ${v_test_data['Allow Printing']}    ${v_test_data['Display Watermark']}
    ...    ${v_test_data['Note']}
    Check File Exist    ${v_test_data['File']}
    #Check Email
    Wait For Email
    ${v_expected_email}=    Evaluate    {'body':[${v_test_data['Expected Email Body']}], 'subject':'${v_test_data['Expected Email Subject']}'}
    ${v_result}=    Check Email Content    ${v_expected_email}
    Should Be Equal    ${v_result}    ${EMPTY}
    # Recipient view received file
    Open Web App    browser2
    SignIn    ${v_test_data['Direct Recipient']}    ${v_test_data['Direct Recipient Pass']}
    Navigate To Folder    ${v_test_data['Received Folder']}
    Check File Exist    ${v_test_data['Received File']}
    [Teardown]    Run Keywords    Submit Test Result    ${v_test_data['TestcaseID']}    ${TEST_STATUS}    AND    Close Connection
    ...    AND    Switch Browser    browser1    AND    Delete File    ${v_test_data['File']}
    ...    AND    Close All Browsers
