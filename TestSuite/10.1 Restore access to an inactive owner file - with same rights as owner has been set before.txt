*** Settings ***
Test Setup        Run Keywords    Get Test Case ID From Test Case Name    AND    fsweb_Load Data From File    ${cfg_test_data_location}/Restore Access.xlsx    ${v_testcaseID}    AND
...               Open Web App    AND    SignIn    ${v_data['Owner email address']}    ${v_data['Owner password']}
Test Teardown     Close All Browsers
Resource          ../Resource/BusinessKeywords.txt
Resource          ../Resource/LogicKeywords.txt

*** Test Cases ***
fs[4005]_Restore access for direct recipient who is revoked by owner and has no downstream recipient
    #    A share to B with right
    #    Get all rights data
    #    Restore access with right the same data
    ${v_defaultValueOfStringAFile}=    Get Default Sharing Setting From Data    ${v_data['Access level']}    ${v_data['Allow printing']}    ${v_data['Display watermark']}
    Open Restore Access Screen From List File    ${v_data['Filename owner']}    ${v_data['Recipient email address']}
    ${v_currentValueOfRestoreAccess}=    Get Default Value Of Restore Access Popup
    fsweb_Verify Default String Value On User Preferences And Add Recipient Model    ${v_defaultValueOfStringAFile}    ${v_currentValueOfRestoreAccess}
    Wait For Progress Bar
    Click Restore Access Button
    #    Verify file had received
    Receiver Sign In To Invoke File    ${v_data['Owner name']}    ${v_data['Recipient email address']}    ${v_data['Recipient password']}
    Check File Exist    ${v_data['Filename FCS']}
    #    Revoke
    [Teardown]    Run Keywords    Owner Sign In To Invoke File    ${v_data['Owner email address']}    ${v_data['Owner password']}    AND    Revoke All Recipient
    ...    ${v_data['Filename owner']}    AND    Close All Browsers

fs[4218]_Restore access for direct recipient who is revoked by owner and has downstream recipient
    #    open restore access
    #    compare data
    #    restore
    #    verify B received file
    #    B restore access for C
    ${v_defaultValueOfStringAFile}=    Get Default Sharing Setting From Data    ${v_data['Access level']}    ${v_data['Allow printing']}    ${v_data['Display watermark']}
    Open Restore Access Screen From List File    ${v_data['Filename owner']}    ${v_data['Recipient email address']}
    ${v_currentValueOfRestoreAccess}=    Get Default Value Of Restore Access Popup
    fsweb_Verify Default String Value On User Preferences And Add Recipient Model    ${v_defaultValueOfStringAFile}    ${v_currentValueOfRestoreAccess}
    Wait For Progress Bar
    Click Restore Access Button
    #    Verify file had received
    Receiver Sign In To Invoke File    ${v_data['Owner name']}    ${v_data['Recipient email address']}    ${v_data['Recipient password']}
    Check File Exist    ${v_data['Filename FCS']}
    #    B restore access to C
    Restore Access With Default Value    ${v_data['Filename FCS']}    ${v_data['Downstream email address']}
    #    Revoke
    [Teardown]    Run Keywords    Owner Sign In To Invoke File    ${v_data['Owner email address']}    ${v_data['Owner password']}    AND    Revoke All Recipient
    ...    ${v_data['Filename owner']}    AND    Close All Browsers

fs[4010]_Restore access for direct recipient who revoke himself
    ${v_defaultValueOfStringAFile}=    Get Default Sharing Setting From Data    ${v_data['Access level']}    ${v_data['Allow printing']}    ${v_data['Display watermark']}
    Open Restore Access Screen From List File    ${v_data['Filename owner']}    ${v_data['Recipient email address']}
    ${v_currentValueOfRestoreAccess}=    Get Default Value Of Restore Access Popup
    fsweb_Verify Default String Value On User Preferences And Add Recipient Model    ${v_defaultValueOfStringAFile}    ${v_currentValueOfRestoreAccess}
    Wait For Progress Bar
    Click Restore Access Button
    #    Verify file had received
    Receiver Sign In To Invoke File    ${v_data['Owner name']}    ${v_data['Recipient email address']}    ${v_data['Recipient password']}
    Check File Exist    ${v_data['Filename FCS']}
    #    Revoke
    [Teardown]    Run Keywords    Receiver Sign In To Invoke File    ${v_data['Owner name']}    ${v_data['Recipient email address']}    ${v_data['Recipient password']}    AND
    ...    Delete A File    ${v_data['Filename FCS']}    AND    Close All Browsers

fs[4009]_Restore access for direct recipient whose access is expired
    #    open restore access
    #    compare data
    #    restore
    #    verify B received file
    #    B restore access for C
    ${v_defaultValueOfStringAFile}=    Get Default Sharing Setting From Data    ${v_data['Access level']}    ${v_data['Allow printing']}    ${v_data['Display watermark']}
    Open Restore Access Screen From List File    ${v_data['Filename owner']}    ${v_data['Recipient email address']}
    Wait For Progress Bar
    ${v_currentValueOfRestoreAccess}=    Get Default Value Of Restore Access Popup
    fsweb_Verify Default String Value On User Preferences And Add Recipient Model    ${v_defaultValueOfStringAFile}    ${v_currentValueOfRestoreAccess}
    ${v_expirationTime}=    Expiration Increase Current Time    2
    Set Expiration    restoreAccessExpiration    ${v_expirationTime}
    Click Restore Access Button
    #    Verify file had received
    Receiver Sign In To Invoke File    ${v_data['Owner name']}    ${v_data['Recipient email address']}    ${v_data['Recipient password']}
    Check File Exist    ${v_data['Filename FCS']}
    #    Restore with expiration for Recipient

fs[4006]_Restore access for downstream recipient who is revoked by owner
    #    Owner restore for downstream
    #    verify Downstream received file
    ${v_defaultValueOfStringAFile}=    Get Default Sharing Setting From Data    ${v_data['Access level']}    ${v_data['Allow printing']}    ${v_data['Display watermark']}
    Open Restore Access Screen From List File    ${v_data['Filename owner']}    ${v_data['Downstream email address']}
    ${v_currentValueOfRestoreAccess}=    Get Default Value Of Restore Access Popup
    fsweb_Verify Default String Value On User Preferences And Add Recipient Model    ${v_defaultValueOfStringAFile}    ${v_currentValueOfRestoreAccess}
    Wait For Progress Bar
    Click Restore Access Button
    #    Verify file had received
    Receiver Sign In To Invoke File    ${v_data['Owner name']}    ${v_data['Downstream email address']}    ${v_data['Downstream password']}
    Check File Exist    ${v_data['Filename FCS']}
    #    Owner revoke Downstream    Direct Add Downstream(restoreaccess)    Owner revoke Downstream
    Comment    Owner Sign In To Invoke File    ${v_data['Owner email address']}    ${v_data['Owner password']}
    Comment    Revoke Access For A Recipient From List Files    ${v_data['Filename owner']}    ${v_data['Downstream name']}
    Comment    Receiver Sign In To Invoke File    ${v_data['Owner name']}    ${v_data['Recipient email address']}    ${v_data['Recipient password']}
    Comment    Add Downstream With Default Value    ${v_data['Filename FCS']}    ${v_data['Downstream email address']}
    Comment    Comment    Restore Access With Default Value    ${v_data['Filename FCS']}    ${v_data['Downstream email address']}
    Comment    Owner Sign In To Invoke File    ${v_data['Owner email address']}    ${v_data['Owner password']}
    Comment    Revoke Access For A Recipient From List Files    ${v_data['Filename owner']}    ${v_data['Downstream name']}
    [Teardown]    Run Keywords    Owner Sign In To Invoke File    ${v_data['Owner email address']}    ${v_data['Owner password']}    AND    Revoke Access For A Recipient From List Files
    ...    ${v_data['Filename owner']}    ${v_data['Downstream name']}    AND    Receiver Sign In To Invoke File    ${v_data['Owner name']}    ${v_data['Recipient email address']}
    ...    ${v_data['Recipient password']}    AND    Add Downstream With Default Value    ${v_data['Filename FCS']}    ${v_data['Downstream email address']}    AND
    ...    Owner Sign In To Invoke File    ${v_data['Owner email address']}    ${v_data['Owner password']}    AND    Revoke Access For A Recipient From List Files    ${v_data['Filename owner']}
    ...    ${v_data['Downstream name']}    AND    Close All Browsers

fs[4011]_Restore access for downstream recipient who is revoked by direct recipient
    ${v_defaultValueOfStringAFile}=    Get Default Sharing Setting From Data    ${v_data['Access level']}    ${v_data['Allow printing']}    ${v_data['Display watermark']}
    Open Restore Access Screen From List File    ${v_data['Filename owner']}    ${v_data['Downstream email address']}
    ${v_currentValueOfRestoreAccess}=    Get Default Value Of Restore Access Popup
    fsweb_Verify Default String Value On User Preferences And Add Recipient Model    ${v_defaultValueOfStringAFile}    ${v_currentValueOfRestoreAccess}
    Wait For Progress Bar
    Click Restore Access Button
    #    Verify file had received
    Receiver Sign In To Invoke File    ${v_data['Owner name']}    ${v_data['Downstream email address']}    ${v_data['Downstream password']}
    Check File Exist    ${v_data['Filename FCS']}
    #    Owner revoke Downstream    Direct Add Downstream(restoreaccess)    Owner revoke Downstream
    Comment    Switch Browser And Reload Page    1
    Comment    Revoke Access For A Recipient From List Files    ${v_data['Filename owner']}    ${v_data['Downstream name']}
    Comment    #
    Comment    Reload Page FileString
    Comment    Restore Access With Default Value    ${v_data['Filename owner']}    ${v_data['Recipient email address']}
    Comment    #
    Comment    Receiver Sign In To Invoke File    ${v_data['Owner name']}    ${v_data['Recipient email address']}    ${v_data['Recipient password']}
    Comment    Add Downstream With Default Value    ${v_data['Filename FCS']}    ${v_data['Downstream email address']}
    Comment    Comment    Receiver Sign In To Invoke File    ${v_data['Owner name']}    ${v_data['Downstream email address']}    ${v_data['Downstream password']}
    Comment    Reload Page FileString
    Comment    Revoke Access For A Recipient From List Files    ${v_data['Filename FCS']}    ${v_data['Downstream name']}
    Comment    Switch Browser And Reload Page    1
    Comment    Revoke Access For A Recipient From List Files    ${v_data['Filename owner']}    ${v_data['Recipient name']}
    [Teardown]    Run Keywords    Switch Browser And Reload Page    1    AND    Revoke Access For A Recipient From List Files    ${v_data['Filename owner']}
    ...    ${v_data['Downstream name']}    AND    Reload Page FileString    AND    Restore Access With Default Value    ${v_data['Filename owner']}
    ...    ${v_data['Recipient email address']}    AND    Receiver Sign In To Invoke File    ${v_data['Owner name']}    ${v_data['Recipient email address']}    ${v_data['Recipient password']}
    ...    AND    Add Downstream With Default Value    ${v_data['Filename FCS']}    ${v_data['Downstream email address']}    AND    Reload Page FileString
    ...    AND    Revoke Access For A Recipient From List Files    ${v_data['Filename FCS']}    ${v_data['Downstream name']}    AND    Switch Browser And Reload Page
    ...    1    AND    Revoke Access For A Recipient From List Files    ${v_data['Filename owner']}    ${v_data['Recipient name']}    AND
    ...    Close All Browsers

fs[4714]_Owner set new rights when restore access in cases-Direct recipient has NOT been reshared file, Owner revoke then restore him
    Open Restore Access Screen From List File    ${v_data['Filename owner']}    ${v_data['Recipient email address']}
    Change All Rights Value On RestoreAccess Form
    Click Restore Access Button
    Comment    Owner Sign In To Invoke File    ${v_data['Owner email address']}    ${v_data['Owner password']}
    Comment    Revoke All Recipient    ${v_data['Filename owner']}
    Receiver Sign In To Invoke File    ${v_data['Owner name']}    ${v_data['Recipient email address']}    ${v_data['Recipient password']}
    Check File Exist    ${v_data['Filename FCS']}
    [Teardown]    Run Keywords    Owner Sign In To Invoke File    ${v_data['Owner email address']}    ${v_data['Owner password']}    AND    Revoke All Recipient
    ...    ${v_data['Filename owner']}    AND    Close All Browsers

fs[4715]_Owner set new rights when restore access in cases-Direct recipient has been reshared file, Owner revoke then restore him
    Open Restore Access Screen From List File    ${v_data['Filename owner']}    ${v_data['Recipient email address']}
    Change All Rights Value On RestoreAccess Form
    Click Restore Access Button
    #
    Receiver Sign In To Invoke File    ${v_data['Owner name']}    ${v_data['Recipient email address']}    ${v_data['Recipient password']}
    Check File Exist    ${v_data['Filename FCS']}
    #    Change right Direct-R
    Comment    Wait For Progress Bar
    Comment    Reload Page FileString
    Switch Browser And Reload Page    1
    View Recipients From List File    ${v_data['Filename owner']}
    Open Change Rights Popup From View Recipients    ${v_data['Recipient email address']}
    Change All Rights Value On ChangeRight Form
    Click Button Save On Change Rights Form
    #    Add Downstream
    Receiver Sign In To Invoke File    ${v_data['Owner name']}    ${v_data['Recipient email address']}    ${v_data['Recipient password']}
    Add Downstream With Default Value    ${v_data['Filename FCS']}    ${v_data['Downstream email address']}
    Comment    Owner Sign In To Invoke File    ${v_data['Owner email address']}    ${v_data['Owner password']}
    Comment    Revoke All Recipient    ${v_data['Filename owner']}
    [Teardown]    Run Keywords    Owner Sign In To Invoke File    ${v_data['Owner email address']}    ${v_data['Owner password']}    AND    Revoke All Recipient
    ...    ${v_data['Filename owner']}    AND    Close All Browsers

fs[4716]_Owner set new rights when restore access in cases-Owner revoke all then restore access for downstream recipient
    #    Restore access for downstream with new rights
    #    Revoke all-> add recipient-> add downstream=> revoke all
    Open Restore Access Screen From List File    ${v_data['Filename owner']}    ${v_data['Downstream email address']}
    Change All Rights Value On RestoreAccess Form
    Click Restore Access Button
    #
    Receiver Sign In To Invoke File    ${v_data['Owner name']}    ${v_data['Downstream email address']}    ${v_data['Downstream password']}
    Check File Exist    ${v_data['Filename FCS']}
    Switch Browser And Reload Page    1
    Comment    Wait For Progress Bar
    Comment    Reload Page FileString
    Revoke All Recipient    ${v_data['Filename owner']}
    Wait For Progress Bar
    Reload Page FileString
    Add Recipient With Default Value    ${v_data['Filename owner']}    ${v_data['Recipient email address']}
    Receiver Sign In To Invoke File    ${v_data['Owner name']}    ${v_data['Recipient email address']}    ${v_data['Recipient password']}
    Add Downstream With Default Value    ${v_data['Filename FCS']}    ${v_data['Downstream email address']}
    [Teardown]    Run Keywords    Owner Sign In To Invoke File    ${v_data['Owner email address']}    ${v_data['Owner password']}    AND    Revoke All Recipient
    ...    ${v_data['Filename owner']}    AND    Close All Browsers

fs[6255]_Owner set new rights when restore access in cases-Reduce rights for all rights when restore access for direct recipient has downstream recipients
    Open Restore Access Screen From List File    ${v_data['Filename owner']}    ${v_data['Recipient email address']}
    Change All Rights Value On RestoreAccess Form
    Click Restore Access Button
    #
    Receiver Sign In To Invoke File    ${v_data['Owner name']}    ${v_data['Recipient email address']}    ${v_data['Recipient password']}
    Check File Exist    ${v_data['Filename FCS']}
    #    Change right Direct-R
    Switch Browser And Reload Page    1
    View Recipients From List File    ${v_data['Filename owner']}
    Open Change Rights Popup From View Recipients    ${v_data['Recipient email address']}
    Change All Rights Value On ChangeRight Form
    Click Button Save On Change Rights Form
    #    Add Downstream
    Receiver Sign In To Invoke File    ${v_data['Owner name']}    ${v_data['Recipient email address']}    ${v_data['Recipient password']}
    Add Downstream With Default Value    ${v_data['Filename FCS']}    ${v_data['Downstream email address']}
    Comment    Owner Sign In To Invoke File    ${v_data['Owner email address']}    ${v_data['Owner password']}
    Comment    Revoke Access For A Recipient From List Files    ${v_data['Filename owner']}    ${v_data['Recipient name']}
    [Teardown]    Run Keywords    Owner Sign In To Invoke File    ${v_data['Owner email address']}    ${v_data['Owner password']}    AND    Revoke Access For A Recipient From List Files
    ...    ${v_data['Filename owner']}    ${v_data['Recipient name']}    AND    Close All Browsers
