*** Settings ***
Test Setup        Run Keywords    Get Test Case ID From Test Case Name    AND    fsweb_Load Data From File    ${cfg_test_data_location}/Revoke Access.xlsx    ${v_testcaseID}    AND
...               Open Web App    AND    SignIn    ${v_data['Owner email address']}    ${v_data['Owner password']}
Test Teardown     Close All Browsers
Resource          ../Resource/BusinessKeywords.txt

*** Test Cases ***
fs[3091]_Owner can revoke a Direct Recipient not affect Downstream
    Revoke Access For A Recipient From List Files    ${v_data['Filename owner']}    ${v_data['Recipient name']}
    #    Verify File Had Been Revoked at Recipient
    Verify File Had Been Revoke From Owner Or D-Recipient    ${v_data['Recipient email address']}    ${v_data['Recipient password']}    ${v_data['Owner name']}    ${v_data['Filename FCS']}
    [Teardown]    Run Keywords    Owner Sign In To Invoke File    ${v_data['Owner email address']}    ${v_data['Owner password']}    AND    Restore Access With Default Value
    ...    ${v_data['Filename owner']}    ${v_data['Recipient email address']}    AND    Close All Browsers    # Run Keywords | Owner Sign In To Invoke File | ${v_data['Owner email address']} | ${v_data['Owner password']} | AND | Restore Access With Default Value | ${v_data['Filename owner']} | ${v_data['Recipient email address']} | AND | Close All Browsers

fs[3092]_Owner can revoke a Direct Recipient affect Downstream
    Revoke Access For A Recipient From List Files    ${v_data['Filename owner']}    ${v_data['Recipient name']}
    #    Verify File Had Been Revoked at Recipient
    Verify File Had Been Revoke From Owner Or D-Recipient    ${v_data['Recipient email address']}    ${v_data['Recipient password']}    ${v_data['Owner name']}    ${v_data['Filename FCS']}
    Verify File Had Been Revoke From Owner Or D-Recipient    ${v_data['Downstream email address']}    ${v_data['Downstream password']}    ${v_data['Recipient name']}    ${v_data['Filename FCS']}
    [Teardown]    Run Keywords    Owner Sign In To Invoke File    ${v_data['Owner email address']}    ${v_data['Owner password']}    AND    Restore Access With Default Value
    ...    ${v_data['Filename owner']}    ${v_data['Recipient email address']}    AND    Receiver Sign In To Invoke File    ${v_data['Owner name']}    ${v_data['Recipient email address']}
    ...    ${v_data['Recipient password']}    AND    Restore Access With Default Value    ${v_data['Filename FCS']}    ${v_data['Downstream email address']}    AND
    ...    Close All Browsers

fs[2003]_Owner can revoke a Downstream who is an user
    Revoke Access For A Recipient From List Files    ${v_data['Filename owner']}    ${v_data['Downstream name']}
    Verify File Had Been Revoke From Owner Or D-Recipient    ${v_data['Downstream email address']}    ${v_data['Downstream password']}    ${v_data['Recipient name']}    ${v_data['Filename FCS']}
    [Teardown]    Run Keywords    Receiver Sign In To Invoke File    ${v_data['Owner name']}    ${v_data['Recipient email address']}    ${v_data['Recipient password']}    AND
    ...    Restore Access With Default Value    ${v_data['Filename FCS']}    ${v_data['Downstream email address']}    AND    Close All Browsers

fs[3094]_Direct-Recipient can revoke one downstream who is an user
    Open Web App
    SignIn    ${v_data['Recipient email address']}    ${v_data['Recipient password']}
    Go To Sender Folder From All Files    ${v_data['Owner name']}
    Revoke Access For A Recipient From List Files    ${v_data['Filename FCS']}    ${v_data['Downstream name']}
    Verify File Had Been Revoke From Owner Or D-Recipient    ${v_data['Downstream email address']}    ${v_data['Downstream password']}    ${v_data['Recipient name']}    ${v_data['Filename FCS']}
    [Teardown]    Run Keywords    Receiver Sign In To Invoke File    ${v_data['Owner name']}    ${v_data['Recipient email address']}    ${v_data['Recipient password']}    AND
    ...    Restore Access With Default Value    ${v_data['Filename FCS']}    ${v_data['Downstream email address']}    AND    Close All Browsers

fs[3096]_Direct recipient can revoke one recipient second time in case this recipient was resent file
    Open Web App
    SignIn    ${v_data['Recipient email address']}    ${v_data['Recipient password']}
    Go To Sender Folder From All Files    ${v_data['Owner name']}
    Revoke Access For A Recipient From List Files    ${v_data['Filename FCS']}    ${v_data['Downstream name']}
    Verify File Had Been Revoke From Owner Or D-Recipient    ${v_data['Downstream email address']}    ${v_data['Downstream password']}    ${v_data['Recipient name']}    ${v_data['Filename FCS']}
    Switch Browser And Reload Page    2
    Restore Access With Default Value    ${v_data['Filename FCS']}    ${v_data['Downstream email address']}
    Wait For Progress Bar
    Reload Page
    Wait For Loading Screen
    Revoke Access For A Recipient From List Files    ${v_data['Filename FCS']}    ${v_data['Downstream name']}
    Switch Browser And Reload Page    3
    Verify File Invisible In List File    ${v_data['Filename FCS']}
    [Teardown]    Run Keywords    Receiver Sign In To Invoke File    ${v_data['Owner name']}    ${v_data['Recipient email address']}    ${v_data['Recipient password']}    AND
    ...    Restore Access With Default Value    ${v_data['Filename FCS']}    ${v_data['Downstream email address']}    AND    Close All Browsers

fs[3095]_Owner can revoke one recipient second time in case this recipient was resent file
    Revoke Access For A Recipient From List Files    ${v_data['Filename owner']}    ${v_data['Recipient name']}
    #    Verify File Had Been Revoked at Recipient
    Verify File Had Been Revoke From Owner Or D-Recipient    ${v_data['Recipient email address']}    ${v_data['Recipient password']}    ${v_data['Owner name']}    ${v_data['Filename FCS']}
    Switch Browser And Reload Page    1
    Restore Access With Default Value    ${v_data['Filename owner']}    ${v_data['Recipient email address']}
    Wait For Progress Bar
    Reload Page
    Wait For Loading Screen
    Revoke Access For A Recipient From List Files    ${v_data['Filename owner']}    ${v_data['Recipient name']}
    Switch Browser And Reload Page    2
    Verify File Invisible In List File    ${v_data['Filename FCS']}
    [Teardown]    Run Keywords    Owner Sign In To Invoke File    ${v_data['Owner email address']}    ${v_data['Owner password']}    AND    Restore Access With Default Value
    ...    ${v_data['Filename owner']}    ${v_data['Recipient email address']}    AND    Close All Browsers

fs[3505]_Owner can revoke all direct recipients who are users
    Revoke All Recipient    ${v_data['Filename owner']}
    Verify Inactive Recipient From List File    ${v_data['Filename owner']}    ${v_data['Recipient name 1']}
    Verify Inactive Recipient From List File    ${v_data['Filename owner']}    ${v_data['Recipient name 2']}
    #    Verify File had been revoke
    Verify File Had Been Revoke From Owner Or D-Recipient    ${v_data['Recipient email address 1']}    ${v_data['Recipient password 1']}    ${v_data['Owner name']}    ${v_data['Filename FCS']}
    Verify File Had Been Revoke From Owner Or D-Recipient    ${v_data['Recipient email address 2']}    ${v_data['Recipient password 2']}    ${v_data['Owner name']}    ${v_data['Filename FCS']}
    #    Restore access
    Switch Browser And Reload Page    1
    [Teardown]    Run Keywords    Restore Access For Two Recipient    ${v_data['Filename owner']}    ${v_data['Recipient email address 1']}    ${v_data['Recipient email address 2']}    AND
    ...    Close All Browsers

fs[2008]_Owner can revoke all direct recipients who are non-users
    Revoke All Recipient    ${v_data['Filename owner']}
    Verify Inactive Recipient From List File    ${v_data['Filename owner']}    ${v_data['Recipient name 1']}
    Verify Inactive Recipient From List File    ${v_data['Filename owner']}    ${v_data['Recipient name 2']}
    #    Verify File had been revoke
    Get All Link From Gmail    ${v_data['Recipient name 1']}    ${v_data['Recipient email address 1']}    ${v_data['Recipient password 1']}
    Wrapper.Open Browser    ${v_allLinks[1]}
    Wait For Progress Bar
    Verify Error Alert With Message    ${v_data['Message']}
    Delete All Gmail    ${v_data['Recipient email address 1']}    ${v_data['Recipient password 1']}
    [Teardown]    Run Keywords    Owner Sign In To Invoke File    ${v_data['Owner email address']}    ${v_data['Owner password']}    AND    Restore Access For Two Recipient
    ...    ${v_data['Filename owner']}    ${v_data['Recipient email address 1']}    ${v_data['Recipient email address 2']}    AND    Close All Browsers    AND    Delete All Gmail    ${v_data['Recipient email address 1']}    ${v_data['Recipient password 1']}

fs[2009]_Owner can revoke all downstream recipients who are users by deleting each recipient continuosly
    Revoke Access For A Recipient From List Files    ${v_data['Filename owner']}    ${v_data['Downstream name 1']}
    Revoke Access For A Recipient From File Info    ${v_data['Downstream name 2']}
    Wait For Progress Bar
    Wait Until Page Contains Element    //div[@class = "spinner spinner-icon hidden"]
    Verify Inactive Recipient In FileInfo    ${v_data['Downstream name 2']}
    #    Verify File Had Been Revoked
    Verify File Had Been Revoke From Owner Or D-Recipient    ${v_data['Downstream email address 1']}    ${v_data['Downstream password 1']}    ${v_data['Recipient name']}    ${v_data['Filename FCS']}
    Verify File Had Been Revoke From Owner Or D-Recipient    ${v_data['Downstream email address 2']}    ${v_data['Downstream password 2']}    ${v_data['Recipient name']}    ${v_data['Filename FCS']}
    [Teardown]    Run Keywords    Receiver Sign In To Invoke File    ${v_data['Owner name']}    ${v_data['Recipient email address']}    ${v_data['Recipient password']}    AND
    ...    Restore Access For Two Downstream    ${v_data['Filename FCS']}    ${v_data['Downstream email address 1']}    ${v_data['Downstream email address 2']}    AND    Close All Browsers    AND    Delete All YahooMail    ${v_data['Downstream email address 1']}    ${v_data['Downstream password 1']}

fs[2010]_Owner can revoke all downstream recipients who are non-users by deleting each recipient continuosly
    Revoke Access For A Recipient From List Files    ${v_data['Filename owner']}    ${v_data['Downstream name 1']}
    Revoke Access For A Recipient From File Info    ${v_data['Downstream name 2']}
    Wait For Progress Bar
    Wait Until Page Contains Element    ${FileInfo_SprinnerLoading}
    Verify Inactive Recipient In FileInfo    ${v_data['Downstream name 2']}
    #    Verify Email
    Get All Link From YahooMail    ${v_data['Downstream email address 1']}    ${v_data['Downstream password 1']}
    Wrapper.Open Browser    ${v_allLinks[1]}
    Wait For Progress Bar
    Verify Error Alert With Message    ${v_data['Error message']}
    Delete All YahooMail    ${v_data['Downstream email address 1']}    ${v_data['Downstream password 1']}
    [Teardown]    Run Keywords    Receiver Sign In To Invoke File    ${v_data['Owner name']}    ${v_data['Recipient email address']}    ${v_data['Recipient password']}    AND
    ...    Restore Access For Two Downstream    ${v_data['Filename FCS']}    ${v_data['Downstream email address 1']}    ${v_data['Downstream email address 2']}    AND    Close All Browsers

fs[2011]_Owner can revoke file access of all recipients in case no impacted downstream recipients
    Revoke All Recipient    ${v_data['Filename owner']}
    Verify Inactive Recipient From List File    ${v_data['Filename owner']}    ${v_data['Recipient name 1']}
    Verify Inactive Recipient From List File    ${v_data['Filename owner']}    ${v_data['Recipient name 2']}
    #    Verify File had been revoke
    Verify File Had Been Revoke From Owner Or D-Recipient    ${v_data['Recipient email address 1']}    ${v_data['Recipient password 1']}    ${v_data['Owner name']}    ${v_data['Filename FCS']}
    Verify File Had Been Revoke From Owner Or D-Recipient    ${v_data['Recipient email address 2']}    ${v_data['Recipient password 2']}    ${v_data['Owner name']}    ${v_data['Filename FCS']}
    #    Restore access
    [Teardown]    Run Keywords    Owner Sign In To Invoke File    ${v_data['Owner email address']}    ${v_data['Owner password']}    AND    Restore Access For Two Recipient
    ...    ${v_data['Filename owner']}    ${v_data['Recipient email address 1']}    ${v_data['Recipient email address 2']}    AND    Close All Browsers

fs[2012]_Owner can revoke file access of all recipients in case having impacted downstream recipients
    Revoke All Recipient    ${v_data['Filename owner']}
    Verify Inactive Recipient From List File    ${v_data['Filename owner']}    ${v_data['Recipient name']}
    Verify Inactive Recipient From List File    ${v_data['Filename owner']}    ${v_data['Downstream name']}
    Verify File Had Been Revoke From Owner Or D-Recipient    ${v_data['Recipient email address']}    ${v_data['Recipient password']}    ${v_data['Owner name']}    ${v_data['Filename FCS']}
    Verify File Had Been Revoke From Owner Or D-Recipient    ${v_data['Downstream email address']}    ${v_data['Downstream password']}    ${v_data['Owner name']}    ${v_data['Filename FCS']}
    #    Restore Access
    [Teardown]    Run Keywords    Owner Sign In To Invoke File    ${v_data['Owner email address']}    ${v_data['Owner password']}    AND    Restore Access With Default Value
    ...    ${v_data['Filename owner']}    ${v_data['Recipient email address']}    AND    Receiver Sign In To Invoke File    ${v_data['Owner name']}    ${v_data['Recipient email address']}
    ...    ${v_data['Recipient password']}    AND    Restore Access With Default Value    ${v_data['Filename FCS']}    ${v_data['Downstream email address']}    AND
    ...    Close All Browsers

fs[2013]_Direct recipient can revoke all downstream recipient who are users
    Open Web App
    SignIn    ${v_data['Recipient email address']}    ${v_data['Recipient password']}
    Go To Sender Folder From All Files    ${v_data['Owner name']}
    Revoke All Recipient    ${v_data['Filename FCS']}
    Verify Inactive Recipient From List File    ${v_data['Filename FCS']}    ${v_data['Downstream name 1']}
    Verify Inactive Recipient From List File    ${v_data['Filename FCS']}    ${v_data['Downstream name 2']}
    #    Verify file revoke at downstream
    Verify File Had Been Revoke From Owner Or D-Recipient    ${v_data['Downstream email address 1']}    ${v_data['Downstream password 1']}    ${v_data['Recipient name']}    ${v_data['Filename FCS']}
    Verify File Had Been Revoke From Owner Or D-Recipient    ${v_data['Downstream email address 2']}    ${v_data['Downstream password 2']}    ${v_data['Recipient name']}    ${v_data['Filename FCS']}
    #    Verify file revoked at Owner
    Switch Browser And Reload Page    1
    Verify Inactive Recipient From List File    ${v_data['Filename owner']}    ${v_data['Downstream name 1']}
    Verify Inactive Recipient From List File    ${v_data['Filename owner']}    ${v_data['Downstream name 2']}
    #    Restore Access
    [Teardown]    Run Keywords    Receiver Sign In To Invoke File    ${v_data['Owner name']}    ${v_data['Recipient email address']}    ${v_data['Recipient password']}    AND
    ...    Restore Access For Two Downstream    ${v_data['Filename FCS']}    ${v_data['Downstream email address 1']}    ${v_data['Downstream email address 2']}    AND    Close All Browsers

fs[2016]_Owner can revoke file access successfully for all recipients (>100)
    Revoke All Recipient    ${v_data['Filename owner']}
    Verify Inactive Recipient From List File    ${v_data['Filename owner']}    ${v_data['Recipient name 1']}
    Verify Inactive Recipient From List File    ${v_data['Filename owner']}    ${v_data['Recipient name 2']}
    #    Verify File had been revoke
    Verify File Had Been Revoke From Owner Or D-Recipient    ${v_data['Recipient email address 1']}    ${v_data['Recipient password 1']}    ${v_data['Owner name']}    ${v_data['Filename FCS']}
    Verify File Had Been Revoke From Owner Or D-Recipient    ${v_data['Recipient email address 2']}    ${v_data['Recipient password 2']}    ${v_data['Owner name']}    ${v_data['Filename FCS']}
    #    Restore access
    Comment    Owner Sign In To Invoke File    ${v_data['Owner email address']}    ${v_data['Owner password']}
    Comment    Add Recipient With Default Value    ${v_data['Filename owner']}    ${v_data['List recipient']}
    Comment    Switch Browser And Reload Page    1
    Comment    Right Click File    ${v_data['Filename owner']}
    Comment    Click    ${MenuWhenRightClickOnAFile_String}
    Comment    fsweb_Verify_Reshare Popup Should Exist
    Comment    Wait For Progress Bar
    Comment    fsweb_Input Recipient On Add Recipient Popup    ${v_data['List recipient']}
    Comment    Click    ${Reshare_StringButton}
    [Teardown]    Run Keywords    Owner Sign In To Invoke File    ${v_data['Owner email address']}    ${v_data['Owner password']}    AND    Add Recipient With Default Value
    ...    ${v_data['Filename owner']}    ${v_data['List recipient']}    AND    Close All Browsers

fs[2017]_Direct recipient can revoke file access successfully to all his recipients (>100)
    Open Web App
    SignIn    ${v_data['Recipient email address']}    ${v_data['Recipient password']}
    Go To Sender Folder From All Files    ${v_data['Owner name']}
    Revoke All Recipient    ${v_data['Filename FCS']}
    Verify Inactive Recipient From List File    ${v_data['Filename FCS']}    ${v_data['Downstream name 1']}
    Verify Inactive Recipient From List File    ${v_data['Filename FCS']}    ${v_data['Downstream name 2']}
    #    Verify file revoke at downstream
    Verify File Had Been Revoke From Owner Or D-Recipient    ${v_data['Downstream email address 1']}    ${v_data['Downstream password 1']}    ${v_data['Recipient name']}    ${v_data['Filename FCS']}
    Verify File Had Been Revoke From Owner Or D-Recipient    ${v_data['Downstream email address 2']}    ${v_data['Downstream password 2']}    ${v_data['Recipient name']}    ${v_data['Filename FCS']}
    #    Verify file revoked at Owner
    Switch Browser And Reload Page    1
    Verify Inactive Recipient From List File    ${v_data['Filename owner']}    ${v_data['Downstream name 1']}
    Verify Inactive Recipient From List File    ${v_data['Filename owner']}    ${v_data['Downstream name 2']}
    #    Restore Access
    [Teardown]    Run Keywords    Receiver Sign In To Invoke File    ${v_data['Owner name']}    ${v_data['Recipient email address']}    ${v_data['Recipient password']}    AND
    ...    Add Downstream With Default Value    ${v_data['Filename FCS']}    ${v_data['List recipient']}    AND    Close All Browsers

fs[3082]_Where to invoke Revoke Access popup-Revoke 1 recipient from Revoke icon on the File Info
    Revoke Access For A Recipient From List Files    ${v_data['Filename owner']}    ${v_data['Recipient name']}
    #    Verify File Had Been Revoked at Recipient
    Verify File Had Been Revoke From Owner Or D-Recipient    ${v_data['Recipient email address']}    ${v_data['Recipient password']}    ${v_data['Owner name']}    ${v_data['Filename FCS']}
    [Teardown]    Run Keywords    Owner Sign In To Invoke File    ${v_data['Owner email address']}    ${v_data['Owner password']}    AND    Restore Access With Default Value
    ...    ${v_data['Filename owner']}    ${v_data['Recipient email address']}    AND    Close All Browsers

fs[3083]_Where to invoke Revoke Access popup-Revoke All Access from context menu of file
    Revoke All Recipient    ${v_data['Filename owner']}
    Verify Inactive Recipient From List File    ${v_data['Filename owner']}    ${v_data['Recipient name 1']}
    Verify Inactive Recipient From List File    ${v_data['Filename owner']}    ${v_data['Recipient name 2']}
    #    Verify File had been revoke
    Verify File Had Been Revoke From Owner Or D-Recipient    ${v_data['Recipient email address 1']}    ${v_data['Recipient password 1']}    ${v_data['Owner name']}    ${v_data['Filename FCS']}
    Verify File Had Been Revoke From Owner Or D-Recipient    ${v_data['Recipient email address 2']}    ${v_data['Recipient password 2']}    ${v_data['Owner name']}    ${v_data['Filename FCS']}
    #    Restore access
    Switch Browser And Reload Page    1
    [Teardown]    Run Keywords    Restore Access For Two Recipient    ${v_data['Filename owner']}    ${v_data['Recipient email address 1']}    ${v_data['Recipient email address 2']}    AND
    ...    Close All Browsers
