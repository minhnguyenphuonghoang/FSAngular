*** Settings ***
Test Setup        Run Keywords    Get Test Case ID From Test Case Name    AND    fsweb_Load Data From File    ${v_pathToWebPreviewDataFile}    ${v_testcaseID}
Test Teardown     Run Keywords    fsweb_Submit Test Status Into Testlink    ${v_testcaseID}    AND    Close All Browsers
Resource          ../Resource/WebPreview.txt
Resource          ../Resource/AddRecipients.txt

*** Test Cases ***
fs[19468]_Double click on row to view fsc +owner file
    Comment    Open owner file
    Open Web App
    SignIn    ${v_data['Owner email address']}    ${v_data['Owner password']}
    fsweb_Open A File Or Folder    ${v_data['Owner filename']}
    fsweb_Verify File Is Opened Correctly    ${cfg_sikuli_baseddir}/7.1 Web Preview/${v_data['Owner img file']}    0.97
    Close All Browsers
    Comment    Open fcs file
    Open Web App
    SignIn    ${v_data['Recipient email address']}    ${v_data['Recipient password']}
    fsweb_Open A File Or Folder    FileString Received Files
    fsweb_Open A File Or Folder    ${v_data['Owner fullname']}
    fsweb_Open A File Or Folder    ${v_data['Recipient filename']}
    fsweb_Verify File Is Opened Correctly    ${cfg_sikuli_baseddir}/7.1 Web Preview/${v_data['Recipient img file']}    0.97

fs[19470]_Click on file name to view fsc + owner file
    Comment    Open owner file
    Open Web App
    SignIn    ${v_data['Owner email address']}    ${v_data['Owner password']}
    Click File    ${v_data['Owner filename']}
    fsweb_Verify File Is Opened Correctly    ${cfg_sikuli_baseddir}/7.1 Web Preview/${v_data['Owner img file']}    0.97
    Close All Browsers
    Comment    Open fcs file
    Open Web App
    SignIn    ${v_data['Recipient email address']}    ${v_data['Recipient password']}
    fsweb_Open A File Or Folder    FileString Received Files
    fsweb_Open A File Or Folder    ${v_data['Owner fullname']}
    Click File    ${v_data['Recipient filename']}
    fsweb_Verify File Is Opened Correctly    ${cfg_sikuli_baseddir}/7.1 Web Preview/${v_data['Recipient img file']}    0.97

fs[19472]_From context menu to view fcs + owner file
    Comment    Open owner file
    Open Web App
    SignIn    ${v_data['Owner email address']}    ${v_data['Owner password']}
    Right Click File    ${v_data['Owner filename']}
    Click    ${MenuWhenRightClickOnAFile_Open}
    fsweb_Verify File Is Opened Correctly    ${cfg_sikuli_baseddir}/7.1 Web Preview/${v_data['Owner img file']}    0.97
    Close All Browsers
    Comment    Open fcs file
    Open Web App
    SignIn    ${v_data['Recipient email address']}    ${v_data['Recipient password']}
    fsweb_Open A File Or Folder    FileString Received Files
    fsweb_Open A File Or Folder    ${v_data['Owner fullname']}
    Right Click File    ${v_data['Recipient filename']}
    Click    ${MenuWhenRightClickOnAFile_Open}
    fsweb_Verify File Is Opened Correctly    ${cfg_sikuli_baseddir}/7.1 Web Preview/${v_data['Recipient img file']}    0.97

fs[25525]_Select file and click open "eye-icon" on toolbar
    Comment    Open owner file
    Open Web App
    SignIn    ${v_data['Owner email address']}    ${v_data['Owner password']}
    Select File    ${v_data['Owner filename']}
    Click    ${Toolbar_View}
    fsweb_Verify File Is Opened Correctly    ${cfg_sikuli_baseddir}/7.1 Web Preview/${v_data['Owner img file']}    0.97
    Close All Browsers
    Comment    Open fcs file
    Open Web App
    SignIn    ${v_data['Recipient email address']}    ${v_data['Recipient password']}
    fsweb_Open A File Or Folder    FileString Received Files
    fsweb_Open A File Or Folder    ${v_data['Owner fullname']}
    Select File    ${v_data['Recipient filename']}
    Click    ${Toolbar_View}
    fsweb_Verify File Is Opened Correctly    ${cfg_sikuli_baseddir}/7.1 Web Preview/${v_data['Recipient img file']}    0.97
